# -*- coding: utf-8 -*-
"""PropuestaConcursoAPP.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1IJ5Oh3fXAhNWqbS4FcdPs6Lv9rAu2WXa
"""

# Proyecto: Â¿QuÃ© tipo de inversor eres?
# Desarrollado por: Alejandro CaÃ±as, Emmanuel GarcÃ­a, Maricielo GÃ³mez
# DescripciÃ³n: App que determina el perfil del inversor y analiza acciones con Python.

pip install streamlit yfinance

import streamlit as st
import pandas as pd
import numpy as np
import yfinance as yf
import matplotlib.pyplot as plt

# Initialize session state for 'perfil' at the beginning of the script
if 'perfil' not in st.session_state:
    st.session_state.perfil = None

tab1, tab2, tab3 = st.tabs(["ğŸ‘¤ Perfil del Inversor", "ğŸ“ˆ SimulaciÃ³n de Portafolio", "ğŸ“š Referencias"])

with tab1:

    st.title("ğŸ’¸ Â¿QuÃ© tipo de inversor eres?")
    st.write("")
    st.title("âœ¨ Tu estilo, tu riesgo, tu inversiÃ³n.")
    st.markdown("""
    Esta app te ayuda a identificar tu *perfil de inversor* y analizar el comportamiento de acciones reales.""")
    st.markdown("Elige tus preferencias y descubre cÃ³mo se ajustan a los distintos tipos de portafolio.")
    st.markdown("*Desarrollado por: Alejandro CaÃ±as, Emmanuel GarcÃ­a, Maricielo GÃ³mez*")

    # ğŸ§­ CUESTIONARIO DE PERFIL
    st.title("ğŸ§© Cuestionario del inversor")
    st.header("ğŸ‘¤ Descubre tu perfil de inversor")
    st.markdown("Responde las siguientes preguntas para determinar tu tolerancia al riesgo, horizonte y conocimiento.")
    st.markdown("---")

    puntaje_total = 0

    st.header("I. Tolerancia al riesgo (Tu ReacciÃ³n a la volatilidad)")

    # Pregunta 1: ReacciÃ³n a la PÃ©rdida
    q1 = st.radio(
        "1. Si su portafolio cayera un 20% en un mes, usted...",
        ('A) VenderÃ­a inmediatamente, no tolero mÃ¡s pÃ©rdidas. (1 punto)',
        'B) MantendrÃ­a la inversiÃ³n, esperando la recuperaciÃ³n. (3 puntos)',
        'C) InvertirÃ­a mÃ¡s para aprovechar los precios bajos. (5 puntos)'),
        index=None  # Sin selecciÃ³n por defecto
    )
    if q1:
        puntaje_total += int(q1.split('(')[-1].split()[0])

    # Pregunta 2: Prioridad de inversiÃ³n
    q2 = st.radio(
    "2. Â¿QuÃ© es mÃ¡s importante para usted?",
    ('A) Preservar el capital y obtener un retorno bajo pero seguro. (1 punto)',
    'B) Equilibrio entre crecimiento y seguridad. (3 puntos)',
    'C) MÃ¡ximo rendimiento, aceptando un riesgo significativo. (5 puntos)'),
    index=None
    )
    if q2:
    puntaje_total += int(q2.split('(')[-1].split()[0])

    # Pregunta 3: Volatilidad Aceptable
    q3 = st.radio(
        "3. Â¿QuÃ© porcentaje de caÃ­da estÃ¡ dispuesto a aceptar en su capital en un aÃ±o?",
        ('A) Menos del 5%. (1 punto)',
        'B) Entre 10% y 20%. (3 puntos)',
        'C) MÃ¡s del 25%. (5 puntos)'),
        index=None
    )
    if q3:
        puntaje_total += int(q3.split('(')[-1].split()[0])

    st.markdown("---")

# --- SECCIÃ“N II: HORIZONTE DE INVERSIÃ“N (2 Preguntas) ---
st.header("II. Horizonte de InversiÃ³n (Plazo)")

# Pregunta 4: Mayor Objetivo
q4 = st.radio(
"4. Â¿Para quÃ© objetivo principal estÃ¡ destinando este dinero?",
('A) Necesidades a corto plazo (1-3 aÃ±os). (1 punto)',
  'B) Mediano plazo (3-7 aÃ±os). (3 puntos)',
  'C) Largo plazo/JubilaciÃ³n (mÃ¡s de 7 aÃ±os). (5 puntos)'),
index=None
)
if q4:
puntaje_total += int(q4.split('(')[-1].split()[0])

# Pregunta 5: Momento de Retiro
q5 = st.radio(
"5. Â¿En cuÃ¡ntos aÃ±os planea retirar la mayor parte de este capital?",
('A) Menos de 2 aÃ±os. (1 punto)',
  'B) 5 a 10 aÃ±os. (3 puntos)',
  'C) MÃ¡s de 15 aÃ±os. (5 puntos)'),
index=None
)
if q5:
puntaje_total += int(q5.split('(')[-1].split()[0])

st.markdown("---")

# --- SECCIÃ“N III: CONOCIMIENTO Y EXPERIENCIA (2 Preguntas) ---
st.header("III. Conocimiento y Experiencia")

# Pregunta 6: Familiaridad con MÃ©tricas
q6 = st.radio(
"6. Â¿QuÃ© tan familiarizado estÃ¡ con el Ratio de Sharpe o el Modelo CAPM?",
('A) Nada familiarizado. (1 punto)',
  'B) Entiendo los conceptos bÃ¡sicos. (3 puntos)',
  'C) Los uso frecuentemente en mi anÃ¡lisis. (5 puntos)'),
index=None
)
if q6:
puntaje_total += int(q6.split('(')[-1].split()[0])

# Pregunta 7: Experiencia con Instrumentos
q7 = st.radio(
"7. Â¿En quÃ© tipos de activos ha invertido o analizado con frecuencia?",
('A) Solo Cuentas de Ahorro, DepÃ³sitos (CDTs) y Fondos de inversiÃ³n colectiva. (1 punto)',
  'B) Acciones individuales (AAPL, MSFT) y Bonos. Entiendo la diversificaciÃ³n. (3 puntos)',
  'C) Futuros, Opciones, Criptomonedas, o he usado Apalancamiento/Venta en Corto. (5 puntos)'),
index=None
)
if q7:
puntaje_total += int(q7.split('(')[-1].split()[0])

st.markdown("---")

# --- BOTÃ“N Y CÃLCULO FINAL ---

# Se verifica que todas las preguntas hayan sido respondidas antes de permitir el cÃ¡lculo
preguntas_respondidas = all([q1, q2, q3, q4, q5, q6, q7])

if st.button("Calcular mi Perfil de Inversor"):
if preguntas_respondidas:

    st.subheader("ğŸ‰ Resultado de tu Perfil de Inversor")
    st.metric("PuntuaciÃ³n Total", puntaje_total)

    # LÃ³gica de ClasificaciÃ³n del Perfil (Basada en 7-35 puntos)
    if puntaje_total <= 15:
        perfil = "Conservador (PreservaciÃ³n del Capital)ğŸ›¡ï¸"
        st.success(f"Tu perfil es: **{perfil}**")
        st.write("Tu prioridad es la seguridad. Se recomienda invertir en activos de Renta Fija y baja volatilidad.")
        st.session_state.perfil = "CONSERVADOR" # Initialize session state

    elif puntaje_total <= 25:
        perfil = "Moderado / Equilibrado (Crecimiento y Estabilidad) ğŸŒ¿"
        st.info(f"Tu perfil es: **{perfil}**")
        st.write("Buscas un balance. Se recomienda una cartera diversificada que combine renta fija y renta variable (Modelo Markowitz).")
        st.session_state.perfil = "MODERADO" # Initialize session state

    else: # puntaje_total > 25
        perfil = "Arriesgado / Crecimiento (MÃ¡ximo Rendimiento) ğŸ”¥"
        st.warning(f"Tu perfil es: **{perfil}**")
        st.write("Tienes una alta tolerancia al riesgo y conocimiento. Se recomienda enfocarse en la eficiencia del portafolio (Ratio de Sharpe).")
        st.session_state.perfil = "ARRIESGADO" # Initialize session state

else:
    st.error("Por favor, responde todas las preguntas para obtener tu resultado.")

with tab2:
    st.header("ğŸ“ˆ SimulaciÃ³n de Portafolio y Resultados")
    st.markdown("---")

    # Usamos el estado de sesiÃ³n guardado en la PestaÃ±a 1
    if st.session_state.perfil is None:
        st.error("ğŸ›‘ Por favor, completa el **Cuestionario del Inversor** en la pestaÃ±a anterior para desbloquear la simulaciÃ³n.")
    else:
        st.success(f"Perfil Actual: **{st.session_state.perfil}**. Â¡Configura tu simulaciÃ³n!")